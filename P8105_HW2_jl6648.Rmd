---
title: "P8105_HW2_jl6648"
output: html_document
date: "2023-09-27"
---

```{r}
library(tidyverse)
library(dplyr)
```

## problem 1
```{r}
pols_df = 
  read_csv("fivethirtyeight_datasets/pols-month.csv") |> #read dataset and clean names 
  janitor::clean_names() |> 
  separate(mon, into = c("year", "mon", "day"), sep = "-") |>  #separate the month variable
  mutate(year = as.numeric(year),  
          mon = as.numeric(mon), 
          day = as.numeric(day)) |> # change new variables to numeric 
  mutate(mon = month.abb[mon], #replace month number with name, create a new variable president
         president = case_when(prez_gop == "1" ~ "gop", prez_dem == "1" ~ "dem")) |> 
  select(-c(prez_gop, prez_dem, day)) # drop variable 
```

Description of pols_df:
The dataset contains 822 observations, 9 variables including year, mon, gov_gop, sen_gop, rep_gop, gov_dem, sen_dem, rep_dem, and president. Variable mon is divided into three new variable (year, mon day). The range of year is from 1947 to 2015. president is a new variable combined with prez_gop and prez_dem. three variable (prez_gop, prez_dem, day) is dropped from original dataset. 

```{r}
snp_df =
  read_csv("fivethirtyeight_datasets/snp.csv") |> #read the dataset and clean variable names.
  janitor::clean_names() |>
  separate(date, into = c("day", "mon", "year"), sep = "/") |> #separate the month variable
  mutate(year = as.numeric(year), 
          mon = as.numeric(mon),    # change new variables to numeric 
          day = as.numeric(day)) |>
  mutate(mon = month.abb[mon]) |>  #replace month number with name
  select(year, mon, everything(), -c(day)) |> # select columns 
  relocate(year, mon)  #organize year and month as the leading columns
```

Description of snp_df,
the dataset contains 787 observations, three variables including year, mon, close. Use the same method to separate mon variable into year, mon, day from original dataset. Then, drop the day variable. The range of year is from 1950 to 2015. 

```{r}
unemploy_df =
  read_csv("fivethirtyeight_datasets/unemployment.csv") |> #read the dataset and clean variable names.
  pivot_longer( 
      Jan:Dec,                           #switch “wide” to “long” format
      names_to = "mon",
      values_to = "unemployment") |>
  rename(year = Year) |>    #change the name, keep consistent with other dataset
  relocate(year, mon)       #organize year and month as the leading columns
```

Description of unemploy_df,
The dataset contains 816 observations, three variables including year, mon, unemployment. Pivot_long function is used to reshape the data, then create a new variable unemployment. Rename the variable Year to year, keep it consistent with other dataset. The range of year is from 1948 to 2015.  

```{r}
joindata_df =
  left_join(pols_df, snp_df, by = c("year", "mon")) #join the  two datasets by same column "year"&"mon"

joindata_df2 =                #merging unemploy_df into the result.
  left_join(joindata_df, unemploy_df,  by = c("year", "mon"))
```

Description of joindata_df and joindata_df2:
joindata_df joined by pols_df and snp_df with same column year and mon. It contains 822 observations and 10 variables. The range of year is from 1947 to 2015. 
joindata_df joined by joindata_df and unemploy_df with the same column year and mon. It contains 822 observations and 11 variables. The range of year is from 1947 to 2015.

## problem 2 

```{r}
Wheel_df =
  readxl::read_excel("202207 Trash Wheel Collection Data.xlsx",
  sheet = "Mr. Trash Wheel",
  range = "A2:N549") |>
  janitor::clean_names() |>
  drop_na("dumpster") |>
  mutate(homes_powered = weight_tons*500/30,
         year = as.integer(year), 
         dataset = "Mr. Trash") 
```

```{r}
professor_df =
  readxl::read_excel("202207 Trash Wheel Collection Data.xlsx",
  sheet = "Professor Trash Wheel",
  range = "A2:M96") |>
  janitor::clean_names() |>
  drop_na("dumpster") |>
  mutate(homes_powered = weight_tons*500/30,
         dataset = "Professor Trash" )
```

```{r}
Gwynnda_df =
  readxl::read_excel("202207 Trash Wheel Collection Data.xlsx",
  sheet = "Gwynnda Trash Wheel",
  range = "A2:K108") |>
  janitor::clean_names() |>
  drop_na("dumpster") |>
  mutate(homes_powered = weight_tons*500/30,
         dataset = "Gwynnda Trash")
```

```{r}
TrashWhell_combine =
  bind_rows(Wheel_df, professor_df, Gwynnda_df)
```

```{r}
baseline_df =
  read_csv("data_mci/MCI_baseline.csv") |>
  janitor::clean_names() |>
  mutate(
    sex = replace(sex, sex == 0, "Female"),
    sex = replace(sex, sex == 1, "Male"),
    apoe4 = replace(apoe4, apoe4 == 1, "Yes"),
    apoe4 = replace(apoe4, apoe4 == 0, "No")
  )

filter(baseline_df, age_at_onset > 0)

total_age =
  pull(baseline_df, current_age) 
  mean(total_age)
```

```{r}
filter(baseline_df, sex == "Female" & apoe4 == "Yes")
filter(baseline_df, sex == "Female")
```
63/221 = 0.285 = 28.5%

```{r}
amyloid_df =
  read_csv("data_mci/mci_amyloid.csv") |>
  janitor::clean_names() |>
  rename(id = study_id)
```

the study id in the "mci_amyloid.csv" dataset is inconsistent. id is the cue to find the participate appeared in both dataset. 
```{r}
participant_combine =
  left_join(baseline_df, amyloid_df, by = "id")
```
